<ParameterList>

    <ParameterList name="Debug Output">
        <Parameter name="Write Jacobian to MatrixMarket" type="int" value="0"/>
        <Parameter name="Write Solution to MatrixMarket" type="bool" value="false"/>
    </ParameterList>

    <ParameterList name="Problem">
        <Parameter name="Phalanx Graph Visualization Detail" type="int" value="0"/>
        <Parameter name="Solution Method" type="string" value="Unsteady"/>
        <Parameter name="Name" type="string" value="FELIX Hydrology 2D"/>

        <ParameterList name="Dirichlet BCs">
            <Parameter name="DBC on NS NodeSet1 for DOF Hydraulic Potential" type="double" value="0.0"/>
        </ParameterList>

        <!--ParameterList name="Neumann BCs">
            <Parameter name="NBC on SS SideSet0 for DOF Hydraulic Potential set neumann" type="Array(double)" value="{0.0, 0.0, 0.0, 0.0, 0.0}"/>
        </ParameterList-->

        <ParameterList name="Response Functions">
          <Parameter name="Number" type="int" value="1"/>
          <Parameter name="Response 0" type="string" value="Solution Max Value"/>
          <ParameterList name="ResponseParams 1">
            <Parameter name="Equation" type="int" value="1" />
          </ParameterList>
        </ParameterList>

        <ParameterList name="FELIX Physical Parameters">
            <Parameter name="Water Viscosity" type="double" value="1e-3"/>
            <Parameter name="Water Density" type="double" value="1000"/>
            <Parameter name="Ice Density" type="double" value="900"/>
            <Parameter name="Ice Latent Heat" type="double" value="3e5"/>
            <Parameter name="Gravity Acceleration" type="double" value="10"/>
        </ParameterList>

        <ParameterList name="FELIX Hydrology">
            <Parameter name="Has Melt Opening" type="bool" value="false"/>
            <Parameter name="Transmissivity" type="double" value="1e-5"/>
            <Parameter name="Bed Bumps Height" type="double" value="10"/>
            <Parameter name="Bed Bumps Length" type="double" value="5000"/>
            <Parameter name="Use Net Bump Height" type="bool" value="true"/>
            <Parameter name="Nonlinearity Coefficient" type="double" value="0.0"/> <!-- How much we want to weigh the nonlinear term -->
        </ParameterList>

    </ParameterList> <!-- Problem -->

    <ParameterList name="Regression Results">
      <Parameter  name="Number of Comparisons" type="int" value="1"/>
      <Parameter  name="Test Values" type="Array(double)" value="{8940176.73567}"/>
      <Parameter  name="Number of Sensitivity Comparisons" type="int" value="0"/>
      <Parameter  name="Relative Tolerance" type="double" value="1.0e-4"/>
      <Parameter  name="Absolute Tolerance" type="double" value="1.0e-4"/>
    </ParameterList>

    <ParameterList name="Discretization">
        <Parameter name="Periodic_y BC" type="bool" value="true"/>
        <Parameter name="Workset Size" type="int" value="100"/>
        <Parameter name="1D Elements" type="int" value="50"/>
        <Parameter name="2D Elements" type="int" value="10"/>
        <Parameter name="1D Scale" type="double" value="1000e3"/>
        <Parameter name="2D Scale" type="double" value="10e3"/>
        <Parameter name="Method" type="string" value="STK2D"/>
        <Parameter name="Write points coordinates to ascii file" type="bool" value="false"/>
        <Parameter name="Cell Topology" type="string" value="Triangle"/>
        <Parameter name="Cubature Degree" type="int" value="3"/>
        <Parameter name="Exodus Output File Name" type="string" value="./rectangle_out.exo"/>
        <ParameterList name="Required Fields Info">
            <Parameter name="sliding_velocity Field Type" type="string" value="Node Scalar"/>
            <Parameter name="sliding_velocity Value" type="double" value="1e-7"/>
            <Parameter name="basal_friction Field Type" type="string" value="Node Scalar"/>
            <Parameter name="basal_friction Value" type="double" value="-1e12"/>
            <Parameter name="surface_height Field Type" type="string" value="Node Scalar"/>
            <Parameter name="surface_height File Name" type="string" value="../AsciiMeshes/Rectangle/surface_height.ascii"/>
            <Parameter name="drainage_sheet_depth Field Type" type="string" value="Node Scalar"/>
            <Parameter name="drainage_sheet_depth File Name" type="string" value="../AsciiMeshes/Rectangle/drainage_sheet_depth.ascii"/>
            <Parameter name="ice_thickness Field Type" type="string" value="Node Scalar"/>
            <Parameter name="ice_thickness File Name" type="string" value="../AsciiMeshes/Rectangle/thickness.ascii"/>
            <Parameter name="ice_viscosity Field Type" type="string" value="Elem Scalar"/>
            <Parameter name="ice_viscosity Value" type="double" value="1e13"/>
            <Parameter name="surface_water_input Field Type" type="string" value="Node Scalar"/>
            <Parameter name="surface_water_input Value" type="double" value="2e-10"/>
            <Parameter name="geothermal_flux Field Type" type="string" value="Node Scalar"/>
            <Parameter name="geothermal_flux Value" type="double" value="0.067"/>
        </ParameterList>
    </ParameterList>

    <ParameterList name="Piro">
        <ParameterList name="NOX">
            <ParameterList name="Solver Options">
                <Parameter name="Status Test Check Type" type="string" value="Minimal"/>
            </ParameterList>

            <ParameterList name="Status Tests">
                <Parameter name="Test Type" type="string" value="Combo"/>
                <Parameter name="Combo Type" type="string" value="OR"/>
                <Parameter name="Number of Tests" type="int" value="3"/>

                <ParameterList name="Test 0">
                    <Parameter name="Test Type" type="string" value="NormF"/>
                    <Parameter name="Norm Type" type="string" value="Two Norm"/>
                    <Parameter name="Scale Type" type="string" value="Unscaled"/>
                    <Parameter name="Tolerance" type="double" value="1e-2"/>
                </ParameterList>
                <ParameterList name="Test 1">
                    <Parameter name="Test Type" type="string" value="RelativeNormF"/>
                    <Parameter name="Norm Type" type="string" value="Two Norm"/>
                    <Parameter name="Scale Type" type="string" value="Unscaled"/>
                    <Parameter name="Tolerance" type="double" value="1e-6"/>
                </ParameterList>
                <ParameterList name="Test 2">
                    <Parameter name="Test Type" type="string" value="MaxIters"/>
                    <Parameter name="Maximum Iterations" type="int" value="1"/>
                </ParameterList>
            </ParameterList>

            <ParameterList name="Direction">
                <Parameter name="Method" type="string" value="Newton"/>

                <ParameterList name="Newton">
                    <Parameter name="Forcing Term Method" type="string" value="Constant"/>

                    <ParameterList name="Linear Solver">
                        <Parameter name="Write Linear System" type="bool" value="false"/>
                    </ParameterList>

                    <ParameterList name="Stratimikos Linear Solver">
                        <ParameterList name="NOX Stratimikos Options">
                        </ParameterList>
                        <ParameterList name="Stratimikos">
                            <Parameter name="Linear Solver Type" type="string" value="AztecOO"/>
                            <Parameter name="Preconditioner Type" type="string" value="Ifpack"/>

                            <ParameterList name="Linear Solver Types">
                                <ParameterList name="AztecOO">
                                    <ParameterList name="Forward Solve">
                                        <ParameterList name="AztecOO Settings">
                                            <Parameter name="Aztec Solver" type="string" value="GMRES"/>
                                            <Parameter name="Convergence Test" type="string" value="r0"/>
                                            <Parameter name="Size of Krylov Subspace" type="int" value="4000"/>
                                            <Parameter name="Output Frequency" type="int" value="20"/>
                                        </ParameterList>
                                        <Parameter name="Max Iterations" type="int" value="1500"/>
                                        <Parameter name="Tolerance" type="double" value="1e-9"/>
                                    </ParameterList>
                                </ParameterList>
                            </ParameterList>

                            <ParameterList name="Preconditioner Types">
                                <ParameterList name="Ifpack">
                                    <Parameter name="Overlap" type="int" value="1"/>
                                    <Parameter name="Prec Type" type="string" value="ILU"/>
                                    <ParameterList name="Ifpack Settings">
                                        <Parameter name="fact: level-of-fill" type="int" value="1"/>
                                    </ParameterList>
                                </ParameterList>
                                <ParameterList name="ML">
                                    <Parameter name="Base Method Defaults" type="string" value="none"/>
                                    <ParameterList name="ML Settings">
                                        <Parameter name="default values" type="string" value="SA"/>
                                        <Parameter name="aggregation: damping factor" type="double" value="1.333"/>
                                        <Parameter name="aggregation: local aggregates" type="int" value="1"/>
                                        <Parameter name="aggregation: next-level aggregates per process" type="int" value="128"/>
                                        <Parameter name="aggregation: nodes per aggregate" type="int" value="128"/>
                                        <Parameter name="aggregation: type" type="string" value="METIS"/>
                                        <Parameter name="coarse: max size" type="int" value="1024"/>
                                        <Parameter name="coarse: pre or post" type="string" value="post"/>
                                        <Parameter name="coarse: sweeps" type="int" value="1"/>
                                        <Parameter name="coarse: type" type="string" value="Amesos-KLU"/>
                                        <Parameter name="eigen-analysis: iterations" type="int" value="20"/>
                                        <Parameter name="eigen-analysis: type" type="string" value="power-method"/>
                                        <Parameter name="increasing or decreasing" type="string" value="increasing"/>
                                        <Parameter name="max levels" type="int" value="3"/>
                                        <Parameter name="prec type" type="string" value="MGW"/>
                                        <Parameter name="smoother: Aztec as solver" type="bool" value="false"/>
                                        <Parameter name="smoother: damping factor" type="double" value="0.67"/>
                                        <Parameter name="smoother: pre or post" type="string" value="both"/>
                                        <Parameter name="smoother: sweeps" type="int" value="1"/>
                                        <Parameter name="smoother: type" type="string" value="symmetric Gauss-Seidel"/>
                                    </ParameterList>
                                </ParameterList>
                            </ParameterList>

                        </ParameterList>
                    </ParameterList> <!-- Stratimikos linear solver -->

                    <Parameter name="Rescue Bad Newton Solve" type="bool" value="1"/>
                </ParameterList> <!-- Newton -->
            </ParameterList>

            <ParameterList name="Line Search">
                <Parameter name="Method" type="string" value="Backtrack"/> <!--"Backtrack", "Full Step", and others (See NOX_LineSearch_Factory.C)-->
                <ParameterList name="Full Step">
                    <Parameter name="Full Step" type="double" value="1"/>
                </ParameterList>
                <ParameterList name="Backtrack">
                    <Parameter name="Max Iters" type="int" value="10"/>
                    <Parameter name="Default Step" type="double" value="1."/>
                    <Parameter name="Minimum Step" type="double" value="1e-10"/>
                    <Parameter name="Reduction Factor" type="double" value="0.5"/>
                </ParameterList>
            </ParameterList>

            <Parameter name="Nonlinear Solver" type="string" value="Line Search Based"/>
            <ParameterList name="Printing">
                <Parameter name="Output Precision" type="int" value="3"/>
                <Parameter name="Output Processor" type="int" value="0"/>
                <ParameterList name="Output Information">
                    <Parameter name="Error" type="bool" value="1"/>
                    <Parameter name="Warning" type="bool" value="1"/>
                    <Parameter name="Outer Iteration" type="bool" value="1"/>
                    <Parameter name="Parameters" type="bool" value="0"/>
                    <Parameter name="Details" type="bool" value="0"/>
                    <Parameter name="Linear Solver Details" type="bool" value="0"/>
                    <Parameter name="Stepper Iteration" type="bool" value="1"/>
                    <Parameter name="Stepper Details" type="bool" value="1"/>
                    <Parameter name="Stepper Parameters" type="bool" value="1"/>
                </ParameterList>
            </ParameterList>
        </ParameterList> <!-- NOX-->

    </ParameterList> <!-- Piro -->
</ParameterList>
